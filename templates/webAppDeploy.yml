parameters:
  azureConnection: ''
  webAppName: ''

steps:
  - task: AzureWebApp@1
    displayName: 'Deploy Azure Web App : ${{ parameters.webAppName }}'
    inputs:
      azureSubscription: ${{ parameters.azureConnection }}
      appName: ${{ parameters.webAppName }}
      package: $(Pipeline.Workspace)/drop/$(Build.BuildId).zip

  - task: AzureCLI@2
    displayName: 'Configuring WebApp Startup file'
    inputs:
      azureSubscription: ${{ parameters.azureConnection }}
      scriptType: 'pscore'
      scriptLocation: 'inlineScript'
      inlineScript: |
        Write-Output: 'Configuring App Service to use a Startup File startup.txt'
        az webapp config set --resource-group $(resourceGroupName) --name ${{ parameters.webAppName }} --startup-file "startup.txt"